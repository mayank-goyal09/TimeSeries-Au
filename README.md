# ğŸ¥‡âœ¨ GOLD PRICE ORACLE â€” AI-Powered Price Prediction âœ¨ğŸ¥‡

[![Typing SVG](https://readme-typing-svg.demolab.com?font=Cinzel&weight=700&size=28&duration=3000&pause=1000&color=D4AF37&center=true&vCenter=true&width=1000&lines=Welcome+to+Gold+Price+Oracle+ğŸ¥‡;LSTM+Deep+Learning+Predictions;From+Broken+Model+to+Breakthrough;A+Story+of+Debugging+%26+Discovery;Built+with+TensorFlow+%2B+Streamlit)](https://git.io/typing-svg)

![Python](https://img.shields.io/badge/Python-3.13-blue?logo=python&logoColor=white)
![TensorFlow](https://img.shields.io/badge/TensorFlow-2.x-FF6F00?logo=tensorflow&logoColor=white)
![Keras](https://img.shields.io/badge/Keras-LSTM-D00000?logo=keras&logoColor=white)
![Streamlit](https://img.shields.io/badge/Streamlit-FF4B4B?logo=streamlit&logoColor=white)
![Pandas](https://img.shields.io/badge/Pandas-150458?logo=pandas&logoColor=white)
![scikit-learn](https://img.shields.io/badge/scikit--learn-F7931E?logo=scikit-learn&logoColor=white)
![License](https://img.shields.io/badge/License-MIT-yellow.svg)
![GitHub Actions](https://img.shields.io/badge/GitHub_Actions-Daily_Auto--Update-2088FF?logo=github-actions&logoColor=white)
![YFinance](https://img.shields.io/badge/YFinance-Live_Market_Data-00C853?logo=yahoo&logoColor=white)

<!-- ğŸ”— STREAMLIT APP LINK â€” ACTIVE -->
<p align="center">
  <a href="https://timeseries-au-project.streamlit.app/">
    <img src="https://img.shields.io/badge/ğŸ¥‡_LIVE_DEMO-ACTIVE_NOW-D4AF37?style=for-the-badge&logo=streamlit" alt="Live Demo">
  </a>
  <a href="https://github.com/mayank-goyal09">
    <img src="https://img.shields.io/badge/GitHub-mayank--goyal09-181717?style=for-the-badge&logo=github" alt="GitHub">
  </a>
</p>

---

## ğŸ­ **THE GOLD ORACLE AWAITS** ğŸ­

<p align="center">
  <img src="assets/hero_banner.png" width="800" alt="Gold Price Oracle - AI Prediction Banner">
</p>

<p align="center">
  <b>ğŸ† Predict the future of gold with the power of Deep Learning! ğŸ†</b>
</p>

### ğŸ”¥ LSTM Neural Networks Ã— Smart Data Strategy Ã— Premium Glassmorphism UI = **Gold Price Oracle** ğŸ”¥

---

## ğŸŒŸ **SPECIAL SPOTLIGHT: ACCESS THE ORACLE** ğŸŒŸ

<p align="center">
  <a href="https://timeseries-au-project.streamlit.app/">
    <img src="https://img.shields.io/badge/âœ¨_ENTER_THE_GOLD_VAULT-CLICK_HERE_FOR_LIVE_APP-D4AF37?style=for-the-badge&logo=data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAACXBIWXMAAAsTAAALEwEAmpwYAAAByklEQVR4nO2Vv0vDQBSHPyNRv6B0EnRycOnq5FDExclFf4D+B87i7OCoIDpI6Co4OLmK4CA66SCoS8FF6CDoIOjgIKiT6CDm8R7XpEnTJk1TfOAjt8u9L/e9u3uXf9VfX0TIBZADskAL8IEuEAK5L/IA6EAtpZRyAnmUA5IAFmAAnIDeXwSIAY8pZZU8IA0cl90S4DqS/VpW6UfS/NIsBfI6YAtp0TfSVjAnSAvNAlInpIXmBWmhWUBqaBaQDpoFpJ7UAnIAmEAdIAOkgRrwHpkDZA+YI3OA7KEDSA89QFrMAbIH5sAcyHZA9sAcIHtoDsg+mANkD80BsofmgOyheUAO0BwgeyRvgOxhXkD2MC8ge5gXkD00L8gepAnYk8/oKpkAun8RIMK0qC5IAbvIHJB9ZAbIFpm5gD3ZInMgW2RGf9WAbJFNAXvIHJD9NAdkr7S9XqE+m7uBvIKFvA6YIr36N2CS9OfL64Ap0q9fSAsT3v1CWnjP3YFqAakR7/lV9T+gRrgT9IDUCDfM6TqG0r7N68CkoUeH0u79vA6YInrUknZlHqYFpEYv6V9AasQ94X8X1AlTogV6f41QO6BGuN/9Wv8m+gOn7P6s+qdr7wAAAABJRU5ErkJggg==" alt="Live Access">
  </a>
</p>

<p align="center">
  <i>"Experience the real-time AI prediction engine that fixed a â‚¹52,000 forecasting error!"</i>
</p>

---

> *"The model kept predicting â‚¹25,000 when gold was at â‚¹77,000. This is the story of how we figured out why â€” and fixed it."*


---

## ğŸ“– **THE STORY â€” A Journey of Discovery** ğŸ“–

<p align="center">
  <img src="assets/debugging_journey.png" width="800" alt="The Debugging Journey">
</p>

This isn't just another ML project. **This is a war story.** A tale of a model that lied, a scaler that betrayed us, and the debugging marathon that saved everything.

### ğŸ¬ **Act 1: The Perfect Plan** *(What We Expected)*

We started with a clear vision:

> *"Take 11 years of gold price data (2014-2025), train an LSTM, predict the next 30 days. Simple, right?"*

- âœ… Downloaded historical gold price data (2,848 data points)
- âœ… Built an LSTM model with 128 â†’ 64 neurons
- âœ… Trained for 300 epochs with early stopping
- âœ… Hit "predict"... and everything fell apart ğŸ’€

---

### ğŸ’¥ **Act 2: The Catastrophe** *(When Everything Broke)*

The first prediction came in. We stared at the screen in disbelief:

```
Last Actual Price:  â‚¹77,149  (Jan 2025)
Model Prediction:   â‚¹25,000  ğŸ˜±
```

**The model was predicting prices from 2015!** Gold was at â‚¹77,000 and our "intelligent" AI was confidently saying â‚¹25,000.

<table>
<tr>
<td width="50%" align="center">

### âŒ **What We Expected**

```
â‚¹77,149 â†’ â‚¹77,500 â†’ â‚¹78,000
(Slight upward trend)
```

</td>
<td width="50%" align="center">

### ğŸ’€ **What We Got**

```
â‚¹77,149 â†’ â‚¹60,000 â†’ â‚¹25,000
(Falling off a cliff!)
```

</td>
</tr>
</table>

---

#### ğŸ› **Bug #1: The Scaler Catastrophe** *(The Silent Killer)*

```python
# âŒ WHAT WE HAD (WRONG!)
scaler = MinMaxScaler()
train_scaled = scaler.fit_transform(train)      # Fitted on 80% of data
test_scaled  = scaler.transform(test)            # Test data OUT OF RANGE!

# Scaler learned: Min=â‚¹24,545  Max=â‚¹55,000 (from 2014-2022)
# But test data had: â‚¹60,000 - â‚¹79,000 â†’ SCALED ABOVE 1.0! ğŸš¨
```

**The Problem:** The scaler was trained on old data (2014-2022). It had **never seen prices above â‚¹55,000**. When it encountered â‚¹77,000 in the test set, it scaled it to values above 1.0 â€” completely outside the model's learned range. The inverse transform then mapped predictions back to the middle of the old range: ~â‚¹25,000.

```python
# âœ… THE FIX
scaler = MinMaxScaler()
scaler.fit(df[['Price']].values)   # Fit on ALL data: â‚¹24,545 - â‚¹79,257
```

---

#### ğŸ› **Bug #2: Dense(1) Recursive Predictions** *(Error Snowball)*

```python
# âŒ WHAT WE HAD (WRONG!)
model = Sequential([
    LSTM(64, return_sequences=True),
    LSTM(32),
    Dense(1)    # Predicts only 1 day!
])
# To get 30 days: predict â†’ feed back â†’ predict â†’ feed back â†’ ...
# Each prediction adds ~1% error
# After 30 steps: 30% cumulative error! ğŸ“‰
```

**The Problem:** `Dense(1)` predicts only one day. To forecast 30 days, we had to recursively feed each prediction back as input. **Errors compounded with every step** â€” by day 30, the prediction had drifted ~â‚¹15,000 from reality.

```python
# âœ… THE FIX
model = Sequential([
    LSTM(128, return_sequences=True),
    LSTM(64),
    Dense(30)     # Predicts ALL 30 days at once!
])
# No recursion needed â†’ No error accumulation! âœ¨
```

---

#### ğŸ› **Bug #3: Training on Irrelevant Data** *(The Eureka Moment)*

Even after Bug #1 and #2 were fixed, predictions were still off by 21%:

```
Last actual: â‚¹77,149
Prediction:  â‚¹60,583   (Still 21% off! ğŸ˜¤)
```

Then came the **breakthrough insight:**

> *"Why are we training on â‚¹24,000 prices from 2014? The model needs to learn CURRENT price patterns, not decade-old ones!"*

```python
# âŒ WHAT WE HAD
# Training on ALL data: 2014-2025 (â‚¹24k - â‚¹79k)
# Model's "average" world: â‚¹41,000
# Prediction: Gravitates toward â‚¹41,000-â‚¹60,000

# âœ… THE FIX
# Train ONLY on 2022-2025 data (â‚¹47k - â‚¹79k)
df = df_full[df_full['Date'].dt.year >= 2022]
# Model's "average" world: â‚¹60,000+
# Prediction: Stays in the â‚¹70,000+ range! ğŸ¯
```

---

### ğŸ‰ **Act 4: The Breakthrough** *(Victory!)*

<p align="center">
  <img src="assets/before_after.png" width="800" alt="Before vs After - Prediction Quality">
</p>

After all three fixes, the results transformed completely:

<table>
<tr>
<td width="50%">

### âŒ **BEFORE (3 Bugs)**

| Metric | Value |
|--------|-------|
| Last Price | â‚¹77,149 |
| Prediction | â‚¹25,000 |
| Error | **-67%** ğŸ’€ |
| Verdict | Useless |

</td>
<td width="50%">

### âœ… **AFTER (All Fixed)**

| Metric | Value |
|--------|-------|
| Last Price | â‚¹77,149 |
| Prediction | ~â‚¹77,000+ |
| Error | **< 5%** ğŸ¯ |
| Verdict | Production Ready! |

</td>
</tr>
</table>

---

## ğŸ§  **THE THREE LESSONS** ğŸ§ 

<table>
<tr>
<td align="center" width="33%">

### ğŸ“Š Lesson 1
### **Scaler Must See All Data**

If your scaler hasn't seen the test range, **all predictions will be garbage.** Always fit on the full data range.

</td>
<td align="center" width="33%">

### ğŸ§  Lesson 2
### **Dense(30) > Dense(1) Loop**

Multi-output prediction eliminates error accumulation. Never recursively feed predictions back if you can avoid it.

</td>
<td align="center" width="33%">

### ğŸ“… Lesson 3
### **Recent Data > All Data**

For financial forecasting, recent patterns matter more than historical ones. Train on what's **relevant**, not everything.

</td>
</tr>
</table>

---

### ğŸ” **Act 3: The Investigation** *(Detective Mode Activated)*

We dove deep into every line of code. Hours of debugging. Coffee. More coffee. And then... **we found not one, but THREE critical bugs:**

---

## ğŸ—ï¸ **WHAT WE BUILT** ğŸ—ï¸

<p align="center">
  <img src="assets/streamlit_app_ui.png" width="800" alt="Gold Price Oracle - Streamlit App">
</p>

<table>
<tr>
<td width="50%">

### ğŸ§  **LSTM Prediction Engine**

Our Deep Learning model analyzes 30 days of price history and forecasts the next 30 days â€” all at once!

- ğŸ”® **Multi-Output LSTM** â€” Predicts 30 days simultaneously
- ğŸ“Š **Smart Scaling** â€” MinMaxScaler fitted on full range
- ğŸ¯ **Recent Data Training** â€” 2022-2025 focus
- âš¡ **Fast Inference** â€” Predictions in < 1 second

</td>
<td width="50%">

### ğŸ¨ **Premium Gold UI**

A stunning Streamlit dashboard with glassmorphism design and gold particle effects.

- âœ¨ **Gold Particle Animations** â€” Floating sparkles
- ğŸªŸ **Glassmorphism Cards** â€” Frosted glass aesthetic
- ğŸ“ˆ **Interactive Plotly Charts** â€” Zoom, pan, hover
- ğŸ“¥ **CSV Download** â€” Export forecast data for analysis

</td>
</tr>
<tr>
<td width="50%">

### ğŸ“Š **Data Intelligence**

Smart data processing pipeline that transforms raw CSV into actionable predictions.

- ğŸ“… **11 Years of Data** â€” 2,848 data points (2014-2025)
- ğŸ§¹ **Auto Preprocessing** â€” Missing values, date parsing
- ğŸ“‰ **Key Metrics** â€” MAE, RMSE, % accuracy
- ğŸ”„ **Upload Your Own** â€” Custom CSV support

</td>
<td width="50%">

### ğŸ”® **Forecast Engine**

Two forecast modes for maximum flexibility:

- ğŸ¯ **Direct Forecast** â€” Multi-output, no error drift
- ğŸ”„ **Recursive Forecast** â€” Single-step for comparison
- ğŸ“† **1-30 Day Horizon** â€” Adjustable via slider
- âœ… **Sanity Checks** â€” Auto-validates predictions

</td>
</tr>
</table>

---

## ğŸ¤– **THE AUTONOMOUS SYSTEM â€” Self-Updating & Self-Training** ğŸ¤–

> *"What if the model could update itself every single day â€” without anyone touching it?"*

After fixing the 3 bugs, we faced a NEW challenge: **Gold prices kept rising.** The model trained on â‚¹77k data couldn't handle â‚¹156k prices. So we built a **fully autonomous pipeline** that keeps the Oracle alive forever.

<p align="center">
  <img src="assets/automation_pipeline.png" width="800" alt="Daily Automation Pipeline">
</p>

<table>
<tr>
<td width="50%">

### ğŸ”„ **Live Market Data Feed**

The system connects to **Yahoo Finance** every morning and pulls real gold prices.

- ğŸ“¡ **Source:** Global Gold Futures (`GC=F`) + USD/INR exchange rate (`INR=X`)
- ğŸ§® **Smart Conversion:** Converts international USD/oz price â†’ Indian â‚¹/10g
- ğŸ’° **Premium Ratio:** Auto-calculates local market premium (taxes, import duty)
- ğŸ“… **Market-Aware:** Skips weekends & holidays automatically

</td>
<td width="50%">

### ğŸ§  **Self-Retraining AI**

After fetching new data, the model **retrains itself** from scratch.

- ğŸ” **Daily Retraining:** 50 epochs on latest 730 days of data
- âš–ï¸ **New Scaler:** MinMaxScaler refits to handle new price ranges
- ğŸ§¹ **Rolling Window:** Keeps exactly **2 years (730 days)** â€” old data auto-deleted
- ğŸš€ **Zero Downtime:** Model + Scaler saved â†’ Streamlit auto-restarts

</td>
</tr>
</table>

### âš™ï¸ **The Daily Automation Cycle (GitHub Actions)**

Every morning at **10:00 AM IST**, a GitHub Actions robot wakes up and runs this pipeline:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    â° 10:00 AM IST â€” DAILY TRIGGER                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                      â”‚
â”‚  Step 1: ğŸ“¡ FETCH          daily_data_update.py                      â”‚
â”‚          â”œâ”€ Download Gold Futures (GC=F) from Yahoo Finance          â”‚
â”‚          â”œâ”€ Download USD/INR exchange rate (INR=X)                   â”‚
â”‚          â”œâ”€ Convert: (USD/31.1g) Ã— 10 Ã— INR Ã— Premium = â‚¹/10g       â”‚
â”‚          â””â”€ Append to Gold Price.csv + trim to 730 days              â”‚
â”‚                                                                      â”‚
â”‚  Step 2: ğŸ§  RETRAIN        train_model.py                            â”‚
â”‚          â”œâ”€ Load updated Gold Price.csv                              â”‚
â”‚          â”œâ”€ Fit new MinMaxScaler on full range                       â”‚
â”‚          â”œâ”€ Train LSTM (64â†’32â†’Dense(30)) for 50 epochs               â”‚
â”‚          â””â”€ Save gold_lstm_multioutput.keras + price_scaler.pkl      â”‚
â”‚                                                                      â”‚
â”‚  Step 3: ğŸ’¾ COMMIT         git push                                  â”‚
â”‚          â”œâ”€ Commit updated CSV + Model + Scaler to GitHub            â”‚
â”‚          â””â”€ Streamlit Cloud auto-deploys! ğŸš€                         â”‚
â”‚                                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ğŸ® **Manual Controls (In-App Buttons)**

Don't want to wait until morning? Use the sidebar buttons:

| Button | What It Does | When To Use |
|--------|-------------|-------------|
| **ğŸ”„ Refresh Data** | Fetches latest prices from Yahoo Finance | When you want today's price NOW |
| **ğŸ§  Retrain AI** | Retrains the LSTM on current data | After a big price jump (e.g., â‚¹77k â†’ â‚¹156k) |

---

## ğŸ¬ **TECH STACK â€” THE VAULT** ğŸ¬

Just like a **gold vault** has multiple layers of security, our project has specialized technologies for each layer:

| **Role** | **Technology** | **Purpose** |
|----------|---------------|-------------|
| ğŸ›ï¸ **The Vault** | ![Python](https://img.shields.io/badge/Python-3.13-3776AB?logo=python&logoColor=white) | Core language orchestrating everything |
| ğŸ§  **The Brain** | ![TensorFlow](https://img.shields.io/badge/TensorFlow-FF6F00?logo=tensorflow&logoColor=white) ![Keras](https://img.shields.io/badge/Keras-D00000?logo=keras&logoColor=white) | LSTM neural network for predictions |
| âš–ï¸ **The Scale** | ![scikit-learn](https://img.shields.io/badge/scikit--learn-F7931E?logo=scikit-learn&logoColor=white) | MinMaxScaler, metrics (MAE, RMSE) |
| ğŸ“Š **The Ledger** | ![Pandas](https://img.shields.io/badge/Pandas-150458?logo=pandas&logoColor=white) ![NumPy](https://img.shields.io/badge/NumPy-013243?logo=numpy&logoColor=white) | Data processing and manipulation |
| ğŸ–¥ï¸ **The Display** | ![Streamlit](https://img.shields.io/badge/Streamlit-FF4B4B?logo=streamlit&logoColor=white) | Premium glassmorphism web interface |
| ğŸ“ˆ **The Charts** | ![Plotly](https://img.shields.io/badge/Plotly-3F4F75?logo=plotly&logoColor=white) | Interactive forecast visualizations |
| ğŸ’¾ **The Safe** | ![Joblib](https://img.shields.io/badge/Joblib-Serialization-blue) | Model & scaler persistence |
| ğŸ“¡ **The Feed** | ![YFinance](https://img.shields.io/badge/YFinance-00C853?logo=yahoo&logoColor=white) | Live gold price data from Yahoo Finance |
| ğŸ¤– **The Robot** | ![GitHub Actions](https://img.shields.io/badge/GitHub_Actions-2088FF?logo=github-actions&logoColor=white) | Daily automated updates & retraining |

### **Full Tech Breakdown:**

| **Category** | **Details** |
|-------------|-------------|
| ğŸ **Language** | Python 3.13 |
| ğŸ§  **Deep Learning** | TensorFlow/Keras â€” LSTM (128â†’64â†’Dense(30)) |
| ğŸ“Š **Data Processing** | Pandas, NumPy, MinMaxScaler |
| ğŸ“ˆ **Visualization** | Plotly Express, Plotly Graph Objects, Matplotlib |
| ğŸ¨ **Frontend** | Streamlit with 600+ lines Custom CSS |
| ğŸ¯ **Metrics** | MAE, RMSE, Percentage Accuracy |
| ğŸ’¾ **Persistence** | Keras (.keras) model, Joblib (.pkl) scaler |
| ğŸ“‚ **Dataset** | Gold Price.csv (2,848 data points, 2014-2025) |

---

## ğŸ”® **HOW IT WORKS â€” THE PREDICTION PIPELINE** ğŸ”®

<p align="center">
  <img src="assets/architecture_pipeline.png" width="800" alt="ML Pipeline Architecture">
</p>

### **The Journey from Raw Data to Gold Forecast:**

---

### ğŸ“¥ **STEP 1: Data Ingestion**

Raw CSV data enters the pipeline with 2,848 days of gold prices.

```python
df = pd.read_csv('Gold Price.csv')
df['Date'] = pd.to_datetime(df['Date'])
# Filter to recent high-price years only
df = df[df['Date'].dt.year >= 2022]  # â† KEY STRATEGY!
```

- ğŸ“… **11 years** of historical data available
- ğŸ¯ **3 years** used for training (2022-2025)
- ğŸ“Š **Price range**: â‚¹47,471 - â‚¹79,257

---

### âš–ï¸ **STEP 2: Smart Scaling**

The scaler normalizes prices to \[0, 1\] range â€” fitted on the FULL dataset.

```python
scaler = MinMaxScaler(feature_range=(0, 1))
scaler.fit(df[['Price']].values)   # â† Sees FULL range!

# â‚¹47,471 â†’ 0.0
# â‚¹79,257 â†’ 1.0
# â‚¹77,149 â†’ ~0.93 (properly scaled!)
```

---

### ğŸ§  **STEP 3: LSTM Prediction**

Our multi-output LSTM reads 30 days of history and predicts the next 30 days simultaneously.

```python
model = Sequential([
    LSTM(64, return_sequences=True, input_shape=(30, 1)),
    Dropout(0.2),
    LSTM(32),
    Dropout(0.2),
    Dense(32, activation='relu'),
    Dense(30)     # â† 30 outputs at once! No recursion!
])
```

---
